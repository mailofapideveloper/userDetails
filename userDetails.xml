<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<l7:Bundle xmlns:l7="http://ns.l7tech.com/2010/04/gateway-management">
    <l7:References>
        <l7:Item>
            <l7:Name>userDetails</l7:Name>
            <l7:Id>17cf448851519e844102a9699eda2d06</l7:Id>
            <l7:Type>SERVICE</l7:Type>
            <l7:TimeStamp>2020-10-15T10:58:16.323-05:00</l7:TimeStamp>
            <l7:Resource>
                <l7:Service id="17cf448851519e844102a9699eda2d06" version="2">
                    <l7:ServiceDetail folderId="17cf448851519e844102a9699eda3538" id="17cf448851519e844102a9699eda2d06" version="2">
                        <l7:Name>userDetails</l7:Name>
                        <l7:Enabled>true</l7:Enabled>
                        <l7:ServiceMappings>
                            <l7:HttpMapping>
                                <l7:UrlPattern>/teamA/v1/userDetails/*</l7:UrlPattern>
                                <l7:Verbs>
                                    <l7:Verb>GET</l7:Verb>
                                </l7:Verbs>
                            </l7:HttpMapping>
                        </l7:ServiceMappings>
                        <l7:Properties>
                            <l7:Property key="internal">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="policyRevision">
                                <l7:LongValue>15</l7:LongValue>
                            </l7:Property>
                            <l7:Property key="soap">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="tracingEnabled">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                            <l7:Property key="wssProcessingEnabled">
                                <l7:BooleanValue>false</l7:BooleanValue>
                            </l7:Property>
                        </l7:Properties>
                    </l7:ServiceDetail>
                    <l7:Resources>
                        <l7:ResourceSet tag="policy">
                            <l7:Resource type="policy" version="14">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"&gt;
    &lt;wsp:All wsp:Usage="Required"&gt;
        &lt;L7p:AuditAssertion&gt;
            &lt;L7p:SaveRequest booleanValue="true"/&gt;
            &lt;L7p:SaveResponse booleanValue="true"/&gt;
        &lt;/L7p:AuditAssertion&gt;
        &lt;L7p:Regex&gt;
            &lt;L7p:AssertionComment assertionComment="included"&gt;
                &lt;L7p:Properties mapValue="included"&gt;
                    &lt;L7p:entry&gt;
                        &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                        &lt;L7p:value stringValue="Operation URI"/&gt;
                    &lt;/L7p:entry&gt;
                &lt;/L7p:Properties&gt;
            &lt;/L7p:AssertionComment&gt;
            &lt;L7p:AutoTarget booleanValue="false"/&gt;
            &lt;L7p:CaptureVar stringValue="operationUri"/&gt;
            &lt;L7p:CaseInsensitive booleanValue="true"/&gt;
            &lt;L7p:IncludeEntireExpressionCapture booleanValue="false"/&gt;
            &lt;L7p:OtherTargetMessageVariable stringValue="request.http.uri"/&gt;
            &lt;L7p:Regex stringValue="\Q/userDetails/\E(.*)"/&gt;
            &lt;L7p:RegexName stringValue="operationUri"/&gt;
            &lt;L7p:Replacement stringValue=""/&gt;
            &lt;L7p:Target target="OTHER"/&gt;
        &lt;/L7p:Regex&gt;
        &lt;L7p:HttpBasic/&gt;
        &lt;wsp:OneOrMore wsp:Usage="Required"&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:SetVariable&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="open_ldap_user_search_filter"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:Base64Expression stringValue="KHNBTUFjY291bnROYW1lPX4p"/&gt;
                    &lt;L7p:VariableToSet stringValue="open_ldap_user_search_filter"/&gt;
                &lt;/L7p:SetVariable&gt;
                &lt;L7p:Regex&gt;
                    &lt;L7p:AutoTarget booleanValue="false"/&gt;
                    &lt;L7p:OtherTargetMessageVariable stringValue="open_ldap_user_search_filter"/&gt;
                    &lt;L7p:Regex stringValue="~"/&gt;
                    &lt;L7p:RegexName stringValue="build search filter"/&gt;
                    &lt;L7p:Replace booleanValue="true"/&gt;
                    &lt;L7p:Replacement stringValue="${operationUri}"/&gt;
                    &lt;L7p:Target target="OTHER"/&gt;
                &lt;/L7p:Regex&gt;
                &lt;L7p:LDAPQuery&gt;
                    &lt;L7p:AssertionComment assertionComment="included"&gt;
                        &lt;L7p:Properties mapValue="included"&gt;
                            &lt;L7p:entry&gt;
                                &lt;L7p:key stringValue="LEFT.COMMENT"/&gt;
                                &lt;L7p:value stringValue="query_ldap_auth1"/&gt;
                            &lt;/L7p:entry&gt;
                        &lt;/L7p:Properties&gt;
                    &lt;/L7p:AssertionComment&gt;
                    &lt;L7p:AttrNames stringArrayValue="included"&gt;
                        &lt;L7p:item stringValue="mail"/&gt;
                        &lt;L7p:item stringValue="givenName"/&gt;
                        &lt;L7p:item stringValue="sn"/&gt;
                        &lt;L7p:item stringValue="cn"/&gt;
                        &lt;L7p:item stringValue="inetUserStatus"/&gt;
                        &lt;L7p:item stringValue="objectClass"/&gt;
                        &lt;L7p:item stringValue="sAMAccountName"/&gt;
                    &lt;/L7p:AttrNames&gt;
                    &lt;L7p:CacheSize intValue="100"/&gt;
                    &lt;L7p:FailIfNoResults booleanValue="true"/&gt;
                    &lt;L7p:LdapProviderOid goidValue="17cf448851519e844102a9699edaa205"/&gt;
                    &lt;L7p:QueryMappings queryAttributeMappings="included"&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="mail"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="mail"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="givenName"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="givenName"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="sn"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="sn"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="cn"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="cn"/&gt;
                            &lt;L7p:Multivalued booleanValue="true"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="inetUserStatus"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="Status"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="objectClass"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="objectClass"/&gt;
                            &lt;L7p:Multivalued booleanValue="true"/&gt;
                        &lt;/L7p:item&gt;
                        &lt;L7p:item mapping="included"&gt;
                            &lt;L7p:AttributeName stringValue="sAMAccountName"/&gt;
                            &lt;L7p:JoinMultivalued booleanValue="false"/&gt;
                            &lt;L7p:MatchingContextVariableName stringValue="Empno"/&gt;
                        &lt;/L7p:item&gt;
                    &lt;/L7p:QueryMappings&gt;
                    &lt;L7p:SearchFilter stringValue="${open_ldap_user_search_filter}"/&gt;
                &lt;/L7p:LDAPQuery&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody stringValue="ewogICAgImZpcnN0TmFtZSI6ICIke2dpdmVuTmFtZX0iLAogICAgImxhc3ROYW1lIjogIiR7c259IiwKICAgICJlbXBJRCI6ICIke0VtcG5vfSIsCiAgICAiZW1haWwiOiAiJHttYWlsfSIKfQ=="/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                &lt;/L7p:HardcodedResponse&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Request Processed Sucessfully"/&gt;
                    &lt;L7p:Level stringValue="WARNING"/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
            &lt;/wsp:All&gt;
            &lt;wsp:All wsp:Usage="Required"&gt;
                &lt;L7p:HardcodedResponse&gt;
                    &lt;L7p:Base64ResponseBody stringValue="ewogICAgIkVyciI6ICJVc2VyIG5vdCBmb3VuZCBpbiBBY3RpdmVEaXJlY3RvcnkiLAp9"/&gt;
                    &lt;L7p:EarlyResponse booleanValue="true"/&gt;
                    &lt;L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/&gt;
                    &lt;L7p:ResponseStatus stringValue="404"/&gt;
                &lt;/L7p:HardcodedResponse&gt;
                &lt;L7p:AuditDetailAssertion&gt;
                    &lt;L7p:Detail stringValue="Request failed"/&gt;
                    &lt;L7p:Level stringValue="WARNING"/&gt;
                &lt;/L7p:AuditDetailAssertion&gt;
            &lt;/wsp:All&gt;
        &lt;/wsp:OneOrMore&gt;
    &lt;/wsp:All&gt;
&lt;/wsp:Policy&gt;
</l7:Resource>
                        </l7:ResourceSet>
                    </l7:Resources>
                </l7:Service>
            </l7:Resource>
        </l7:Item>
    </l7:References>
    <l7:Mappings>
        <l7:Mapping action="NewOrExisting" srcId="17cf448851519e844102a9699eda3538" srcUri="https://drdapl0072104.heb.com:8443/restman/1.0/folders/17cf448851519e844102a9699eda3538" type="FOLDER">
            <l7:Properties>
                <l7:Property key="FailOnNew">
                    <l7:BooleanValue>true</l7:BooleanValue>
                </l7:Property>
            </l7:Properties>
        </l7:Mapping>
        <l7:Mapping action="NewOrExisting" srcId="17cf448851519e844102a9699eda2d06" srcUri="https://drdapl0072104.heb.com:8443/restman/1.0/services/17cf448851519e844102a9699eda2d06" type="SERVICE"/>
    </l7:Mappings>
</l7:Bundle>
